import { Notes, Head, Appear, Image } from "mdx-deck";
import gitHubDependabot from './images/github-dependabot.png'
import gitHubSecurityAlerts from './images/github-security-alerts.png'
import openPRs from './images/open-prs.png'
import openPRs2 from './images/open-prs2.png'
import prDetail from './images/pr-detail.png'
import prDetail2 from './images/pr-detail2.png'
import lmcLogo from './images/lmc-logo.png'
import audit from './images/audit.gif'
import auditResult from './images/audit-result.png'
import slackNoise1 from './images/slack-noise-1.png'
import slackNoise2 from './images/slack-noise-2.png'
import slackNoise3 from './images/slack-noise-3.png'
import pipeline from './images/pipeline.png'
import dependabot from './images/dependabot.png'
import greenkeeper from './images/greenkeeper.png'
import snyk from './images/snyk.webp'
import renovate from './images/renovate.jpg'
import mask from './images/mask.png'
import { default as customTheme } from "./src/theme";
import CenterLayout from './src/components/center-layout'
import Resource from './src/components/resource'
import Link from './src/components/link'
import { FullScreenCode } from 'mdx-deck'
import QuoteLayout from './src/components/qoute-layout'
export const theme = customTheme;

<Head>
  <title>Renovate Your Dependencis – Tomas Litera</title>
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@tomaslitera" />
  <meta
    property="og:image"
    content="http://renovate-your-dependencies.netlify.com/presentation.png"
  />
  <meta
    property="og:title"
    content="Renovate your dependencies – Tomas Litera"
  />
</Head>

<img src={lmcLogo} width="150" />

# Renovate Your Dependencies

[Tomas Litera](https://litera.me)

<Notes>Microphone, screen recording, start timer</Notes>

---

## Motivation

Automagically solve security updates

---

### Security update

<Image src={gitHubDependabot} size="50%" style={{backgroundPosition: 'top'}} />

---

### Security alerts

<Image src={gitHubSecurityAlerts} size="35%" style={{backgroundPosition: 'top'}} />

---

### Security audit

<Image src={audit} size="65%" style={{backgroundPosition: 'top'}} />

---

### 😱

<Image src={auditResult} size="65%" style={{backgroundPosition: 'top'}} />

---

## Idea → Goal

<ul>
  <Appear>
    <li> automated - robots should done all work </li>
    <li> separate branches and pull-request - for better and reliable testing </li>
    <li> on-premise / self-hosted solution - private cloud </li>
    <li> lower / solve security issues </li>
    <li> free / low-cost 😉 </li>
  </Appear>
</ul>

---

<CenterLayout>

## 🕵️‍♂️ Finding solution

</CenterLayout>

---

<img src={dependabot} width="100" />

DependaBot

<ul>
  <Appear>
    <li> ✅ separate PRs </li>
    <li> ✅ security alerts </li>
    <li> ❌ on-premise </li>
    <li> ❗️ GitHub only </li>
  </Appear>
</ul>

<Resource>
  <Link to="https://dependabot.com/" />
</Resource>

---

<img src={greenkeeper} width="100" />

GreenKeeper

<ul>
  <Appear>
    <li> ✅ separate PRs </li>
    <li> ✅ security alerts </li>
    <li> ❌ on-premise </li>
    <li> ❗️ deprecated </li>
  </Appear>
</ul>

<Resource>
  <Link to="https://greenkeeper.io/" />
</Resource>

---

<img src={snyk} width="100" />

Snyk

<ul>
  <Appear>
    <li> ✅ separate PRs </li>
    <li> ✅ security alerts </li>
    <li> ❗️ on-premise ( enterprise plan ) </li>
  </Appear>
</ul>

<Resource>
  <Link to="https://snyk.io/" />
</Resource>

---
<CenterLayout>

# 🤔 ❓

</CenterLayout>

---

<img src={renovate} width="100" />

## Renovate

<ul>
  <Appear>
    <li> ✅ javascript based </li>
    <li> ✅ cli </li>
    <li> ✅ on-premise / self-hosted </li>
    <li> ✅ many package manager (npm, composer, ...) </li>
  </Appear>
</ul>

<Resource>
  <Link to="https://github.com/renovatebot/renovate" />
</Resource>

---

## Vast configuration

<ul>
  <Appear>
    <li> simple setup using json </li>
    <li> autoconfiguration for repos </li>
    <li> presets and extends </li>
    <li> branch prefix </li>
    <li> commit message </li>
    <li> ... </li>
  </Appear>
</ul>

<Resource>
  <Link to="https://docs.renovatebot.com/configuration-options" />
</Resource>

---

<CenterLayout>

## Setup 🏎

</CenterLayout>

---

```json
{
  platform: 'bitbucket-server',
  endpoint: '<server-url>',
  repositories: [
    '~literat/test-renovate-bot-js',
  ],
  enabledManagers: [
    'npm', 'composer',
  ],
}
```

---

```json
{
  "branchPrefix": "dependencies/",
  "commitMessagePrefix": "Deps: ",
},
```

---

<CenterLayout>

## 🚀

</CenterLayout>

---

<Image src={openPRs2} size="50%" style={{backgroundPosition: 'top'}} />

---

<Image src={prDetail2} size="60%" style={{backgroundPosition: 'top'}} />

---

<CenterLayout>

## Problems

</CenterLayout>

<CenterLayout>

😟 😫 😭 😡 🤬 🤯 💩 💥

</CenterLayout>

---

<CenterLayout>

## Lot of noise

</CenterLayout>

<CenterLayout>

🗣 🎶

</CenterLayout>

---

<Image src={slackNoise1} size="60%" style={{backgroundPosition: 'top'}} />

---

<Image src={slackNoise2} size="60%" style={{backgroundPosition: 'top'}} />

---

<Image src={slackNoise3} size="60%" style={{backgroundPosition: 'top'}} />


---

### PR limit

```json
{
  "prConcurrentLimit": 10
}
```

---

### Package grouping

```json
"packageRules": [
  {
    "matchPackagePatterns": [ "eslint" ],
    "groupName": "eslint"
  }
]
```

---

### Scheduling

```json
"packageRules": [
  {
    "matchPackagePatterns": [ "eslint" ],
    "groupName": "eslint",
    "schedule": ["on the first day of the month"]
  }
]
```

---

### Automerging

```json
{
  "updateTypes": ["minor", "patch", "pin", "digest"],
  "automerge": true,
  "automergeType": "pr"
},
```

---

### Automerging → reliable CI/CD

<Image src={pipeline} size="100%" />

---

<CenterLayout>

## 🗣 🎶 → 🎧

</CenterLayout>

---

# Resume

<ul>
  <Appear>
    <li> ✅ on-premise solution </li>
    <li> ✅ automated </li>
    <li> ✅ separate branches and pull-request </li>
    <li> ✅ lower security issues </li>
    <li> ✅ ❌ security checks at all </li>
  </Appear>
</ul>

---

<CenterLayout>

🟢 Stay Up-To-Date

</CenterLayout>

<CenterLayout>

🛡 Stay Safe

</CenterLayout>

---

# 👋

<Resource>
  <Link to="http://frontendisti-renovate-your-dependencies.netlify.com/" />

  Created with ❤️ using <Link to="https://mdx-deck.jxnblk.com/" >mdx-deck</Link>

  📺 <Link to="https://www.youtube.com/watch?v=j-LGtMDYgIQ" /> by <Link to="https://robinpokorny.com/">@robinpokorny</Link>
</Resource>

---

# Resources

<Link to="https://renovate.whitesourcesoftware.com/" style={{display: 'block', paddingTop: '5px', paddingBottom: '5px'}} />
<Link to="https://docs.renovatebot.com/" style={{display: 'block', paddingTop: '5px', paddingBottom: '5px'}} />
<Link to="https://github.com/renovatebot/renovate/blob/master/docs/usage/self-hosted-configuration.md" style={{display: 'block', paddingTop: '5px', paddingBottom: '5px'}} />
<Link to="https://github.com/renovatebot/renovate/blob/master/docs/usage/configuration-options.md" style={{display: 'block', paddingTop: '5px', paddingBottom: '5px'}} />
<Link to="https://www.rarous.net/weblog/2018/09/28/jak-jsme-dali-praci-robotum.html" style={{display: 'block', paddingTop: '5px', paddingBottom: '5px'}} />
